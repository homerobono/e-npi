<div class="body-frame col-sm-10 col-md-9 col-lg-6">
  <app-nav-buttons></app-nav-buttons>
  <h3>Cadastrar Usuário</h3>
  <form [formGroup]='registerForm' (ngSubmit)="registerUser(registerForm.value)">
    <hr>
    <div class="form-row">
      <div class="col-md-12 mb-3">
        <label for="validationCustomEmail">E-Mail</label>
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroupPrepend">@</span>
          </div>
          <input type="text" class="form-control" id="validationCustomEmail" placeholder="E-mail" aria-describedby="inputGroupPrepend" [formControl]="registerForm.controls['email']" > 
          <div [ngClass]="{
            'valid-feedback':registerForm.controls['email'].valid
          }" [ngStyle]="{
            'display' : ( (registerForm.controls['email'].touched &&
            registerForm.controls['email'].valid) ? 'block' : 'none' )
          }"><i class="fa fa-check"></i>
        </div>
        <div [ngClass]="{
          'invalid-feedback':registerForm.controls['email'].invalid
        }" [ngStyle]="{
          'display' : ( (registerForm.controls['email'].touched &&
          !registerForm.controls['email'].pristine &&
          registerForm.controls['email'].invalid) ? 'block' : 'none' )
        }"> Digite um e-mail válido
        </div>
        </div>
      </div>
    </div>
    <hr>
    <div class="form-row">
      <div class="col-md-6 mb-3">
        <label for="validationCustom04">Departamento</label>
        <select class="form-control" id="validationCustom04" placeholder="Departamento" [formControl]="registerForm.controls['department']">
          <option *ngFor="let dept of departments">{{ dept }}</option>
        </select>  
        <div [ngClass]="{
            'valid-feedback':registerForm.controls['department'].valid
          }" [ngStyle]="{
            'display' : ( (registerForm.controls['department'].touched &&
            registerForm.controls['department'].valid) ? 'block' : 'none' )
        }"><i class="fa fa-check"></i>
        </div>
        <div [ngClass]="{
            'invalid-feedback':registerForm.controls['department'].invalid
          }" [ngStyle]="{
            'display' : ( (registerForm.controls['department'].touched &&
            !registerForm.controls['department'].pristine &&
            registerForm.controls['department'].invalid) ? 'block' : 'none' )
          }"> Escolha um departamento
        </div>
      </div>
    </div>
    <div class="form-row">
      <div class="col-md-12 mb-3">
        <label for="validationCustom05">Nível de Permissão</label>

        <div class="form-group">
          <div class='row'>

            <!-- Normal -->
            <div class='col-4'>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" id="defaultInline1" 
                [formControl]="registerForm.controls['level']" name="level" value='0'>
                <label class="custom-control-label" for="defaultInline1">
                    Normal<br>
                    <div class='col-xs-11 radio-level-legend'>
                        Usuário normal, com restrições padrão, 
                        pode visualizar, criar NPI's e O&M's e editá-las, restrito ao seu departamento.
                      </div>
                </label>
              </div>
            </div>
            
            <!-- Master -->
            <div class='col-4'>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" id="defaultInline2" 
                name="level" value='1' [formControl]="registerForm.controls['level']">
                <label class="custom-control-label" for="defaultInline2">
                  Master<br>
                  <div class='col-xs-11 radio-level-legend'>
                    Usuário privilegiado, pode sobrescrever decisões da análise crítica, 
                    independente do departamento. 
                    Pode visualizar usuários.
                  </div>
                </label>
              </div>
            </div>
            
            <!-- Administrador-->
            <div class='col-4'>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" id="defaultInline3"
                name="level" value='2' [formControl]="registerForm.controls['level']">
                <label class="custom-control-label" for="defaultInline3">
                  Administrador<br>
                  <div class='col-xs-11 radio-level-legend'>
                    Usuário com nível de permissão máximo, pode editar qualquer campo. 
                    Deve ser usado somente para propósito de manutenção do sistema.
                    Pode criar/editar/excluir usuários.
                  </div>
                </label>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <hr>
    <div class='alert' *ngIf="registerResponse" [ngClass]="{
      'alert-success' : registerSent,
      'alert-danger' : !registerSent
     }">
      {{ registerResponse }}
    </div>
    <div class="row align-items-center justify-content-center">
      <button type="submit" class="btn btn-success" [disabled]="!registerForm.valid || sendingRegister">Cadastrar Usuário</button>
    </div>
 </form>
</div>
