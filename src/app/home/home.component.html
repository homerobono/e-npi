<div class='container'>
  <div class='row justify-content-center'>
    <div class='col body-main'>
      <div class='row justify-content-between align-items-end'>
        <div class='col align-items-center'>
          <img routerLink='/npi/create' class='btn btn-default btn-create p-0 m-0' data-toggle="tooltip" data-placement="top" title="Criar nova NPI"
            src='/assets/add-button.svg'>
        </div>
        <div class='col-auto text-danger' (click)='refresh()'>
          <a routerLink=# (click)='removeAll()' class='pl-0 pt-2 pb-2 text-danger'>
            <i class='fa fa-trash-o fa-2x text-shadow' data-toggle="tooltip" data-placement="top" title="Remover todas NPI's"></i>
          </a>
        </div>
      </div>
      <div class='row align-items-end'>
        <div class='col-auto ml-auto' (click)='refresh()'>
          <i class='fa fa-refresh refresh' [ngClass]='{"fa-spin" : manualRefresh}' data-toggle="tooltip" data-placement="top" title="Atualizar lista de NPI's"></i>
        </div>
      </div>
      <hr>
      <div *ngIf='!data.length && !gettingNpis' class='text-center'>
        <i class='small text-secondary'>
          Não há NPI's cadastradas no sistema. Clique no botão acima para criar novas NPI's.</i>
      </div>
      <div *ngIf='gettingNpis'>
        <div class='row justify-content-center'>
          <i class='fa fa-circle-o-notch fa-spin fa-4x text-primary '></i>
          <div class='w-100'></div>
          <div>Carregando NPI's...</div>
        </div>
      </div>
      <div *ngIf='!gettingNpis'>
        <div class='row align-items-center m-0 pr-0 d-none d-md-flex sticky-top table-header'>
          <div class='col-lg-1 col-md-2 col'>
            <b class='sort-header' (click)='toggleSortBy("number")'>#</b>
            <span class='fa fa-sort-up ml-2' data-toggle="tooltip" data-placement="top" title="Ordem ascendente por entrada" *ngIf='sortOrder==1 && sortParam == "number"'></span>
            <span class='fa fa-sort-down pl-2' data-toggle="tooltip" data-placement="top" title="Ordem descendente entrada" *ngIf='sortOrder==-1 && sortParam == "number"'></span>
          </div>
          <div class='col'>
            <b class='sort-header' (click)='toggleSortBy("name")'>Nome</b>
            <span class='fa fa-sort-up ml-2' data-toggle="tooltip" data-placement="top" title="Ordem ascendente por nome" *ngIf='sortOrder==1 && sortParam == "name"'></span>
            <span class='fa fa-sort-down pl-2' data-toggle="tooltip" data-placement="top" title="Ordem descendente nome" *ngIf='sortOrder==-1 && sortParam == "name"'></span>
          </div>
          <div class='col col-lg-2 col-md-2 col'>
            <b class='sort-header' (click)='toggleSortBy("entry")'>Entrada</b>
            <span class='fa fa-sort-up ml-2' data-toggle="tooltip" data-placement="top" title="Ordem ascendente por entrada" *ngIf='sortOrder==1 && sortParam == "entry"'></span>
            <span class='fa fa-sort-down pl-2' data-toggle="tooltip" data-placement="top" title="Ordem descendente entrada" *ngIf='sortOrder==-1 && sortParam == "entry"'></span>
          </div>
          <div class='col'>
            <b class='sort-header' (click)='toggleSortBy("stage")'>Status</b>
            <span class='fa fa-sort-up ml-2' data-toggle="tooltip" data-placement="top" title="Ordem ascendente por status" *ngIf='sortOrder==1 && sortParam == "stage"'></span>
            <span class='fa fa-sort-down pl-2' data-toggle="tooltip" data-placement="top" title="Ordem descendente status" *ngIf='sortOrder==-1 && sortParam == "stage"'></span>
          </div>
          <div class='col-lg-1 col-md-2 col-md col'>
            <b class='sort-header' (click)='toggleSortBy("created")'>Criado em</b>
            <span class='fa fa-sort-up ml-2' data-toggle="tooltip" data-placement="top" title="Ordem ascendente por data de criação"
              *ngIf='sortOrder==1 && sortParam == "created"'></span>
            <span class='fa fa-sort-down pl-2' data-toggle="tooltip" data-placement="top" title="Ordem descendente por data de criação"
              *ngIf='sortOrder==-1 && sortParam == "created"'></span>
          </div>
          <div class='col-auto ml-auto mr-0 pr-0 d-none d-md-block justify-content-right align-self-start invisible'>
            <a class='pl-1 pt-2 pb-2 pr-0'>
              <i class='fa fa-fw'></i>
            </a>
            <a class='pl-0 pt-2 pb-2'>
              <i class='fa fa-fw'></i>
            </a>
          </div>
        </div>

        <div class='row align-items-center m-0 pr-0 d-none d-md-flex sticky-top filters-header' [formGroup]='filterForm'>
          <div class='col-lg-1 col-md-2 col'>
            <input type=text class='form-control invisible'>
          </div>
          <div class='col'>
            <input type=text class='form-control' formControlName='name'>
          </div>
          <div class='col col-lg-2 col-md-2 col'>
            <select type=text class='form-control' formControlName='entry'>
              <option selected value></option>
              <option *ngFor='let entry of utils.getEntriesArray(); index as i' value='{{ entry.value }}'>{{ entry.label }}</option>
            </select>
          </div>
          <div class='col'>
            <select type=text class='form-control' formControlName='stage'>
              <option selected value></option>
              <option *ngFor='let status of utils.getStatuses(); index as i' value='{{ i }}'>{{ status }}</option>
            </select>
          </div>
          <div class='col-lg-1 col-md-2 col-md col'>
            <input type=text class='form-control' formControlName='created'>
          </div>
          <div class='col-auto ml-auto mr-0 pr-0 d-none d-md-block justify-content-right align-self-start invisible'>
            <a class='pl-1 pt-2 pb-2 pr-0'>
              <i class='fa fa-fw'></i>
            </a>
            <a class='pl-0 pt-2 pb-2'>
              <i class='fa fa-fw'></i>
            </a>
          </div>
        </div>

        <div class='row rounded align-items-center m-0 pr-0 npi' *ngFor='let npi of npisList' (click)='goToNpi(npi.number)'>
          <div class='col-xs-12 col-lg-1 col-md-2 col-md'>
            <span class='d-none d-md-block col-lg-1 pl-0'>{{ npi.number }}</span>
            <div class='row d-flex d-md-none'>
              <span class='col-3 pl-0'>
                <b>Número: </b>
              </span>
              <span class='col'>{{ npi.number }}</span>
              <div class='col-auto ml-auto mr-0 pr-0 justify-content-right'>
                <button (click)='cancelNPI(npi.id, npi.number, $event)' class='btn btn-danger m-0 shadow-sm p-0'>
                  <i class='fa fa-trash fa-fw'></i>
                </button>
              </div>
              <div class='w-100'></div>
            </div>
          </div>
          <div class='col-xs-12 col-md'>
            <span class='d-none d-md-block m-0 p-0'>{{ npi.name }}</span>
            <div class='row d-flex d-md-none'>
              <div class='col-3 pl-0'>
                <b>Nome: </b>
              </div>
              <span class=col>{{ npi.name }} </span>
              <div class='col-auto ml-auto mr-0 pr-0 justify-content-right'>
                <button routerLink='/npi/{{npi.number}}/edit' class='btn btn-info m-0 shadow-sm p-0'>
                  <i class='fa fa-pencil fa-fw'></i>
                </button>
              </div>
              <div class='w-100'></div>
            </div>
          </div>
          <div class='col-xs-12 col-lg-2 col-md-2 col-md'>
            <span class='d-none d-md-block'>{{ utils.getEntry(npi.entry) }}</span>
            <div class='row d-flex d-md-none'>
              <div class='col-3 pl-0'>
                <b>Entrada: </b>
              </div>
              <span class=col>{{ utils.getEntry(npi.entry) }}</span>
            </div>
            <div class='w-100'></div>
          </div>
          <div class='col-xs-12 col-md'>
            <span class='d-none d-md-block'>{{ utils.getStatus(npi.stage) }}</span>
            <div class='row d-flex d-md-none'>
              <div class='col-3 pl-0'>
                <b>Status: </b>
              </div>
              <span class=col>{{ utils.getStatus(npi.stage) }}</span>
            </div>
            <div class='w-100'></div>
          </div>
          <div class='col-xs-12 col-md col-lg-1 col-md-2 col-md'>
            <span class='d-none d-md-block '>{{ npi.createdString }}</span>
            <div class='row d-flex d-md-none'>
              <div class='col-3 pl-0'>
                <b>Criado em: </b>
              </div>
              <span class='col align-items-center mt-auto'>{{ npi.createdString }}</span>
            </div>
            <div class='w-100'></div>
          </div>
          <div class='col-auto ml-auto mr-0 pr-0 d-none d-md-block justify-content-right align-self-start action-btns'>
            <a routerLink='/npi/{{npi.number}}/edit' class='pl-1 pt-2 pb-2 pr-0 text-info'>
              <i class='fa fa-pencil fa-fw'></i>
            </a>
            <a routerLink=# (click)='cancelNPI(npi.id, npi.number, $event)' class='pl-0 pt-2 pb-2 text-danger'>
              <i class='fa fa-trash fa-fw'></i>
            </a>
          </div>
          <hr class='w-100 d-flex d-md-none'>
        </div>
      </div>
    </div>
  </div>
</div>

<div class='fixed-top text-right mt-5 pt-5 mr-3' style='height:0; overflow: visible' *ngIf='showGoToTopButton'>
  <button style='border-radius: 30px; height: 40px; width: 40px' class='btn btn-light shadow m-auto p-auto' (click)='scrollTo("top")' [@fadeAnimation]>
    <i class='fa fa-chevron-up m-auto p-auto' style='overflow: visible'></i>
  </button>
</div>
<div class='fixed-bottom text-right mb-5 mr-3' style='height:0; overflow: visible' *ngIf='showGoToBottomButton'>
  <button style='border-radius: 30px; height: 40px; width: 40px' class='btn btn-light shadow m-auto p-auto' (click)='scrollTo("bottom")' [@fadeAnimation]>
    <i class='fa fa-chevron-down m-auto p-auto' style='overflow: visible'></i>
  </button>
</div>