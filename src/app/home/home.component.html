<app-navbar></app-navbar>
<div class='container-fluid'>
  <div class='row alert-space align-itens-center'>
    <div class='m-auto col alert alert-dismissible fade show' *ngIf='response' 
    [ngClass]="{'alert-success' : response.type == 'success',
                'alert-warning' : response.type == 'warning',
                'alert-info' : response.type == 'info',
                'alert-danger' : response.type == 'error' }">
                {{ response.message }}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </div>
</div>

<div class='container'>
    <div class='row justify-content-center'>
      <div class='col body-home'>
        <div class='row justify-content-between align-items-end'>
          <div class='col-auto'>
            <button routerLink='/npi/create' class='btn m-0 p-2 btn-orange '
            data-toggle="tooltip" data-placement="top" title="Criar nova NPI">
              <i class='fa fa-plus fa-2x'></i>
              <div>Criar NPI</div>
            </button>
          </div>
          <div class='col-auto' (click)='refresh()'>
            <i class='fa fa-refresh refresh' [ngClass]='{"fa-spin" : manualRefresh}'
            data-toggle="tooltip" data-placement="top" title="Atualizar lista de NPI's"></i>
          </div> 
        </div>
        <hr>
        <div *ngIf='!npisList || gettingNpis'>
          <div class='row justify-content-center'>
            <i class='fa fa-circle-o-notch fa-spin fa-4x text-primary '></i>
            <div class='w-100'></div>
            <div>Carregando NPI's...</div>
          </div>
        </div>
        <div *ngIf='npisList && !gettingNpis'>
          <div class='row align-items-center m-0 pr-0 d-none d-md-flex sticky-top'>
            <div class='col-lg-1 col-md-2 col'>
              <b>Número</b>
            </div>
            <div class='col'>
              <b>Nome</b>
            </div>
            <div class='col col-lg-2 col-md-2 col'>
              <b>Tipo</b>
            </div>
            <div class='col'>
              <b>Status</b>
            </div>
            <div class='col-lg-1 col-md-2 col-md col'>
              <b>Criado em</b>
            </div>
            <div class='d-none d-md-block col-auto ml-auto mr-0 pr-0 justify-content-right invisible'>
              <button class='btn m-0 p-1'>
                <i class='fa fa-fw'></i>
              </button>
              <button class='btn m-0 p-1'>
                <i class='fa fa-fw'></i>
              </button>
            </div> 
          </div>
          <div class='row npi rounded align-items-center m-0 pr-0' *ngFor='let npi of npisList'
            (click)='goToNpi(npi.number)'>
            <div class='col-xs-12 col-lg-1 col-md-2 col-md'>
              <span class='d-none d-md-block col-lg-1'>{{ npi.number }}</span>
              <div class='row d-flex d-md-none'>
                <span class='col-3 pl-0'>
                  <b>Número: </b>
                </span>
                <span class='col'>{{ npi.number }}</span>
                <div class='col-auto ml-auto mr-0 pr-0 justify-content-right'>
                  <button (click)='cancelNPI(npi.id)' class='btn btn-danger m-0 shadow-sm p-0'>
                      <i class='fa fa-trash fa-fw'></i>
                  </button>
                </div>
                <div class='w-100'></div>
              </div>
            </div>
            <div class='col-xs-12 col-md'>
              <span class='d-none d-md-block m-0 p-0'>{{ npi.name }}</span>
              <div class='row d-flex d-md-none'>
                <div class='col-3 pl-0'>
                  <b>Nome: </b>
                </div>
                <span class=col>{{ npi.name }} </span>
                <div class='col-auto ml-auto mr-0 pr-0 justify-content-right'>
                  <button routerLink='/npis' class='btn btn-info m-0 shadow-sm p-0'>
                    <i class='fa fa-pencil fa-fw'></i>
                  </button>
                </div>
                <div class='w-100'></div>
              </div>
            </div>
            <div class='col-xs-12 col-lg-2 col-md-2 col-md'>
              <span class='d-none d-md-block'>{{ npi.entryLabel }}</span>
              <div class='row d-flex d-md-none'>
                <div class='col-3 pl-0'>
                  <b>Entrada: </b>
                </div>
                <span class=col>{{ npi.entryLabel }}</span>
              </div>
              <div class='w-100'></div>
            </div>
            <div class='col-xs-12 col-md'>
              <span class='d-none d-md-block'>{{ npi.status }}</span>
              <div class='row d-flex d-md-none'>
                <div class='col-3 pl-0'>
                  <b>Status: </b>
                </div>
                <span class=col>{{ npi.status }}</span>
              </div>
              <div class='w-100'></div>
            </div>
            <div class='col-xs-12 col-md col-lg-1 col-md-2 col-md'>
              <span class='d-none d-md-block '>{{ npi.createdString }}</span>
              <div class='row d-flex d-md-none'>
                <div class='col-3 pl-0'>
                  <b>Criado em: </b>
                </div>
                <span class='col align-items-center mt-auto'>{{ npi.createdString }}</span>
              </div>
              <div class='w-100'></div>
            </div>            
            <div class='col-auto ml-auto mr-0 pr-0 d-none d-md-block justify-content-right'>
              <button routerLink='/npis' class='btn btn-info m-0 shadow-sm p-1'>
                <i class='fa fa-pencil fa-fw'></i>
              </button>
              <button (click)='cancelNPI(npi._id)' class='btn btn-danger m-0 shadow-sm p-1'>
                <i class='fa fa-trash fa-fw'></i>
              </button>
            </div> 
            <hr class='w-100 d-flex d-md-none'>
          </div>
        </div>
      </div>
    </div>
</div>
